{% extends 'base.html' %}
{% block title %}Grocery Items{% endblock %}

{% block content %}
<div class="view-items-container-full">
  <!-- Categories -->
  <div class="full-bleed" style="background: rgba(255, 255, 255, 0.1); backdrop-filter: blur(10px);">
    <div class="chip-band">
      <div class="chip-row">
        <a href="{{ url_for('view_items', category='fruits') }}" class="category-chip" style="--animation-index: 0;"><i class="fa-solid fa-apple-whole"></i> Fruits</a>
        <a href="{{ url_for('view_items', category='vegetables') }}" class="category-chip" style="--animation-index: 1;"><i class="fa-solid fa-carrot"></i> Vegetables</a>
        <a href="{{ url_for('view_items', category='beverages') }}" class="category-chip" style="--animation-index: 2;"><i class="fa-solid fa-bottle-water"></i> Beverages</a>
        <a href="{{ url_for('view_items', category='snacks') }}" class="category-chip" style="--animation-index: 3;"><i class="fa-solid fa-cookie-bite"></i> Snacks</a>
      </div>
    </div>
  </div>

  <!-- Items Grid -->
  <div class="full-bleed py-2" style="background: rgba(255, 255, 255, 0.1); backdrop-filter: blur(10px);">
    <div class="px-3 px-md-4">
      <h1 class="headline-xl text-center headline-animated" style="margin-bottom:10px;">
        <span class="headline-accent">Available</span> <span style="color: var(--text-dark);">Grocery Items</span>
      </h1>
    </div>
  </div>
  <div class="product-grid full-bleed px-3 px-md-4">
    {% for item in items %}
    <div class="product-card">
      <div class="img-wrap">
        {% if item.image and item.image.strip() %}
          <img src="{{ url_for('static', filename='uploads/' ~ item.image) }}" alt="{{ item.name }}" loading="lazy">
        {% else %}
          <img src="{{ url_for('static', filename='images/default-product.png') }}" alt="Default product image" loading="lazy">
        {% endif %}
      </div>
      <div class="content">
        <div class="title">{{ item.name }}</div>
        <div class="price">â‚¹{{ item.price }}</div>
        <div class="text-muted">{{ item.description or 'No description available.' }}</div>
        {% if item.offer and item.offer != 'None' %}
          <div class="text-muted" style="color: var(--warning); font-weight: 600;">
            <i class="fa-solid fa-fire"></i> {{ item.offer }}
          </div>
        {% endif %}
        <div class="text-muted" style="font-size: 0.8rem;">
          <i class="fa-solid fa-boxes-stacked"></i> Stock: {{ item.stock or item.quantity }}
        </div>
      </div>
      <div class="actions">
        <form action="{{ url_for('add_to_cart', item_id=item._id) }}" method="POST" style="flex: 1;">
          <input type="hidden" name="quantity" value="1">
          <button type="submit" class="btn btn-cart" aria-label="Add {{ item.name }} to cart">
            <i class="fa-solid fa-cart-plus"></i> Add to Cart
          </button>
        </form>
        {% if session.get('user') %}
          <form action="{{ url_for('buy_now_page', item_id=item._id) }}" method="POST" style="flex: 1;">
            <button type="submit" class="btn btn-buy" aria-label="Buy {{ item.name }} now">
              <i class="fa-solid fa-bolt"></i> Buy Now
            </button>
          </form>
        {% else %}
          <a href="{{ safe_url_for('item_routes.login') }}" class="btn btn-buy" style="flex: 1; display: flex; align-items: center; justify-content: center;" aria-label="Login to buy {{ item.name }}">
            <i class="fa-solid fa-bolt"></i> Buy Now
          </a>
        {% endif %}
      </div>
    </div>
    {% endfor %}
  </div>
</div>


{% endblock %}
